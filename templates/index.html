<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alloy Application Form</title>
    <script src="https://cdn.tailwindcss.com"></script>

</head>
<body class="min-h-screen bg-gray-100 flex items-center justify-center p-5">
    <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-2xl w-full">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-3">Alloy Application</h1>
            <p class="text-gray-600 text-lg">Evaluation form</p>
        </div>

        <!-- Result Display -->
        {% if result %}
        <div class="mb-6 p-4 rounded-lg border-l-4 {% if result.class == 'approved' %}bg-green-50 border-green-500{% elif result.class == 'denied' %}bg-red-50 border-red-500{% else %}bg-yellow-50 border-yellow-500{% endif %}">
            <h3 class="font-semibold {% if result.class == 'approved' %}text-green-800{% elif result.class == 'denied' %}text-red-800{% else %}text-yellow-800{% endif %}">{{ result.title }}</h3>
            <p class="{% if result.class == 'approved' %}text-green-700{% elif result.class == 'denied' %}text-red-700{% else %}text-yellow-700{% endif %}">{{ result.message }}</p>
        </div>
        {% endif %}

        <!-- Application Form -->
        <form method="POST" action="/submit" class="space-y-6" id="applicationForm">
            <!-- Name Fields -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="name_first" class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                    <input type="text" id="name_first" name="name_first" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                           placeholder="John" required>
                </div>
                <div>
                    <label for="name_last" class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                    <input type="text" id="name_last" name="name_last" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                           placeholder="Doe" required>
                </div>
            </div>

            <!-- Date of Birth -->
            <div>
                <label for="birth_date" class="block text-sm font-medium text-gray-700 mb-2">Date of Birth</label>
                <input type="date" id="birth_date" name="birth_date" 
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                       required>
            </div>

            <!-- SSN -->
            <div>
                <label for="document_ssn" class="block text-sm font-medium text-gray-700 mb-2">Social Security Number</label>
                <input type="text" id="document_ssn" name="document_ssn" 
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                       placeholder="123456789" pattern="[0-9]{9}" maxlength="9" title="Please enter exactly 9 digits" required>
                <p class="text-sm text-gray-500 mt-1">Enter 9 digits (no spaces or dashes)</p>
            </div>

            <!-- Email -->
            <div>
                <label for="email_address" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                <input type="email" id="email_address" name="email_address" 
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                       placeholder="john.doe@example.com" required>
            </div>

            <!-- Address -->
            <div>
                <label for="address_line_1" class="block text-sm font-medium text-gray-700 mb-2">Street Address</label>
                <input type="text" id="address_line_1" name="address_line_1" 
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                       placeholder="123 Main Street" required>
            </div>

            <!-- City, State, ZIP -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label for="address_city" class="block text-sm font-medium text-gray-700 mb-2">City</label>
                    <input type="text" id="address_city" name="address_city" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                           placeholder="New York" required>
                </div>
                <div>
                    <label for="address_state" class="block text-sm font-medium text-gray-700 mb-2">State</label>
                    <input type="text" id="address_state" name="address_state" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                           placeholder="CA" required>
                </div>
                <div>
                    <label for="address_postal_code" class="block text-sm font-medium text-gray-700 mb-2">ZIP Code</label>
                    <input type="text" id="address_postal_code" name="address_postal_code" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition duration-200" 
                           placeholder="10001" required>
                </div>
            </div>

            <!-- Country (Hidden) -->
            <input type="hidden" name="address_country_code" value="US">

            <!-- Submit Button -->
            <div class="pt-4">
                <button type="submit" 
                        class="w-full bg-black text-white font-semibold py-4 px-6 rounded-lg hover:bg-gray-800 transform hover:scale-[1.02] transition duration-200 shadow-lg">
                    <span class="submit-text">Submit Application</span>
                    <span class="loading-text hidden">
                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        Processing...
                    </span>
                </button>
            </div>
        </form>
    </div>

    <script>
        // Form submission handling
        document.getElementById('applicationForm').addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('button[type="submit"]');
            const submitText = submitBtn.querySelector('.submit-text');
            const loadingText = submitBtn.querySelector('.loading-text');
            
            // Show loading state
            submitText.classList.add('hidden');
            loadingText.classList.remove('hidden');
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-75', 'cursor-not-allowed');
        });

        // SSN input formatting
        document.getElementById('document_ssn').addEventListener('input', function(e) {
            // Remove any non-digit characters
            this.value = this.value.replace(/\D/g, '');
        });

        // Real-time validation feedback
        const inputs = document.querySelectorAll('input[required], select[required]');
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (this.value.trim() === '') {
                    this.classList.add('border-red-500', 'ring-red-500');
                    this.classList.remove('border-gray-300');
                } else {
                    this.classList.remove('border-red-500', 'ring-red-500');
                    this.classList.add('border-gray-300');
                }
            });
        });
    </script>
</body>
</html>